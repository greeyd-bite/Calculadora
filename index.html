<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caja Registradora y Calculadora</title>
    <link rel="stylesheet" href="estilos.css">
</head>
<body>

    <header class="fade-in">
        <h1 class="blink">¡Bienvenidos!</h1>
        <nav>
            <a href="#inicio">Inicio</a>
            <a href="#sobre">Sobre la página</a>
            <a href="#enfoque">Enfoque metodológico</a>
            <a href="#programacion">Programación</a>
            <a href="#contacto">Contacto</a>
        </nav>
    </header>

    <section id="inicio" class="fade-in">
        <h2>Inicio</h2>
        <p>Esta página fue creada con el fin de presentar nuestro proyecto de la calculadora de Fundamentos de Programación. La presente investigación tiene como propósito abordar el desarrollo y la implementación de una herramienta digital básica, como una calculadora web, en el contexto del aprendizaje de fundamentos de programación.</p>
    </section>

    <!-- Caja Registradora (Ahora va primero) -->
    <section id="registradora" class="fade-in registradora">
        <h2>CAJA REGISTRADORA</h2>
        <label>Nombre del producto</label>
        <input type="text" id="nombreProducto" placeholder="Producto">
        <label>Precio del producto:</label>
        <input type="number" id="precioProducto" placeholder="Precio">
        <label>Cantidad:</label>
        <input type="number" id="cantidadProducto" placeholder="1" value="1" min="1">
        <label>Descuento (%):</label>
        <input type="number" id="descuentoProducto" placeholder="0" min="0" max="100" value="0">
        <button onclick="agregarProducto()">Agregar</button>
        <ul id="listaProductos"></ul>
        <h3>IVA (19%): $<span id="ivaValor">0.00</span></h3>
        <h3>Total con IVA: $<span id="total">0.00</span></h3>

        <label>Método de pago:</label>
        <select id="metodoPago">
            <option value="Efectivo">Efectivo</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Transferencia">Transferencia</option>
        </select>

        <button onclick="imprimirRecibo()">Imprimir Recibo</button>
        <button onclick="reiniciarCaja()">Reiniciar</button>
    </section>

    <!-- Calculadora -->
    <section class="fade-in">
        <h2>Calculadora</h2>
        <div class="calculadora">
            <input type="text" id="resultado" readonly>
            <div class="botones">
                <button onclick="agregar('7')">7</button>
                <button onclick="agregar('8')">8</button>
                <button onclick="agregar('9')">9</button>
                <button onclick="agregar('+')">+</button><br>
                <button onclick="agregar('4')">4</button>
                <button onclick="agregar('5')">5</button>
                <button onclick="agregar('6')">6</button>
                <button onclick="agregar('-')">-</button><br>
                <button onclick="agregar('1')">1</button>
                <button onclick="agregar('2')">2</button>
                <button onclick="agregar('3')">3</button>
                <button onclick="agregar('*')">*</button><br>
                <button onclick="agregar('0')">0</button>
                <button onclick="agregar('.')">.</button>
                <button onclick="calcular()">=</button>
                <button onclick="agregar('/')">/</button><br>
                <button onclick="limpiar()">C</button>
            </div>
        </div>
    </section>

    <!-- Resto del contenido -->
    <section id="sobre" class="fade-in">
        <h2>Sobre la página</h2>
        <p>Este proyecto busca representar lo aprendido en clase. Se diseñó una calculadora web funcional usando HTML, CSS y JavaScript como ejercicio práctico de programación básica.</p>
    </section>

    <section id="enfoque" class="fade-in">
        <h2>Enfoque metodológico</h2>
        <ul>
            <li>Metodología exploratorio-práctica: diseño de interfaz, codificación de funciones aritméticas y pruebas de funcionamiento.</li>
        </ul>
    </section>

    <section id="programacion" class="fade-in">
        <h2>Programación</h2>
        <p>Aplicamos los conocimientos adquiridos en Fundamentos de Programación. Usamos HTML para estructurar, CSS para el diseño visual, y JavaScript para la funcionalidad.</p>
    </section>

    <section id="contacto" class="fade-in">
        <h2>Contacto</h2>
        <p>Correo: ejemplo@correo.com</p>
        <button class="boton-brillante">Contáctame</button>
    </section>

    <footer class="fade-in">
        <p>© 2025 Mi Primera Página Web</p>
    </footer>

    <!-- JavaScript actualizado -->
    <script>
        // Calculadora
        function agregar(valor) {
            const campo = document.getElementById('resultado');
            campo.value += valor;
        }

        function calcular() {
            try {
                document.getElementById('resultado').value = eval(document.getElementById('resultado').value);
            } catch (e) {
                alert("Operación inválida");
            }
        }

        function limpiar() {
            document.getElementById('resultado').value = '';
        }

        function borrarUltimo() {
            const campo = document.getElementById('resultado');
            campo.value = campo.value.slice(0, -1);
        }

        document.addEventListener('keydown', function (event) {
            const key = event.key;
            const validKeys = '0123456789+-*/.'.split('');

            if (validKeys.includes(key)) {
                agregar(key);
            } else if (key === 'Enter') {
                event.preventDefault();
                calcular();
            } else if (key.toLowerCase() === 'c') {
                limpiar();
            } else if (key === 'Backspace') {
                borrarUltimo();
            }
        });

        // Registradora con mejoras
        let productos = [];
        let total = 0;

        function agregarProducto() {
            const nombre = document.getElementById("nombreProducto").value.trim();
            const precio = parseFloat(document.getElementById("precioProducto").value);
            const cantidad = parseInt(document.getElementById("cantidadProducto").value) || 1;
            const descuento = parseFloat(document.getElementById("descuentoProducto").value) || 0;

            if (nombre && !isNaN(precio) && cantidad > 0) {
                const subtotalSinDescuento = precio * cantidad;
                const subtotal = subtotalSinDescuento - (subtotalSinDescuento * (descuento / 100));

                productos.push({ nombre, precio, cantidad, descuento, subtotal });
                total += subtotal;

                const li = document.createElement("li");
                li.textContent = `${nombre} x${cantidad} (desc. ${descuento}%): $${subtotal.toFixed(2)}`;
                document.getElementById("listaProductos").appendChild(li);

                actualizarTotales();

                document.getElementById("nombreProducto").value = "";
                document.getElementById("precioProducto").value = "";
                document.getElementById("cantidadProducto").value = "1";
                document.getElementById("descuentoProducto").value = "0";
            } else {
                alert("Por favor, ingresa datos válidos.");
            }
        }

        function actualizarTotales() {
            const iva = total * 0.19;
            const totalConIva = total + iva;

            document.getElementById("ivaValor").textContent = iva.toFixed(2);
            document.getElementById("total").textContent = totalConIva.toFixed(2);
        }

        function imprimirRecibo() {
            let recibo = "RECIBO DE COMPRA\n\n";
            productos.forEach(p => {
                recibo += `${p.nombre} x${p.cantidad} (desc. ${p.descuento}%): $${p.subtotal.toFixed(2)}\n`;
            });
            const iva = total * 0.19;
            const totalConIva = total + iva;
            const metodo = document.getElementById("metodoPago").value;

            recibo += `\nIVA (19%): $${iva.toFixed(2)}\n`;
            recibo += `TOTAL: $${totalConIva.toFixed(2)}\n`;
            recibo += `Método de pago: ${metodo}\n`;

            const win = window.open('', '_blank');
            win.document.write(`<pre>${recibo}</pre>`);
            win.print();
        }

        function reiniciarCaja() {
            productos = [];
            total = 0;
            document.getElementById("listaProductos").innerHTML = "";
            document.getElementById("ivaValor").textContent = "0.00";
            document.getElementById("total").textContent = "0.00";
        }
    </script>

</body>
</html>
